generator client {
  provider        = "prisma-client"
  output          = "../src/generated"
  previewFeatures = ["postgresqlExtensions"] // Required for citext
}

datasource db {
  provider   = "postgresql"
  extensions = [citext]  // Required for @db.Citext
  // url is removed because it is in prisma.config.ts
}

model Clinician {
  clinician_id   String   @id @default(uuid())
  full_name      String
  email          String   @unique @db.Citext
  phone_number   String   @unique
  password_hash  String
  specialization String
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}

model Patient {
  id            String   @id @default(uuid()) // FIXED: Auto-generates ID
  fullName      String
  age           Int?
  gender        String?
  phoneNumber   String   @unique
  email         String   @unique @db.Citext
  passwordHash  String
  oaDiagnosis   Boolean  @default(false)
  affectedKnee  String?
  painSeverity  Int?
  occupation    String?
  activityLevel String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  sensorLogs    SensorLog[]
}

model SensorLog {
  id          String   @id @default(uuid())
  patientId   String
  patient     Patient  @relation(fields: [patientId], references: [id])
  angle       Float
  force       Int
  skinTemp    Float
  battery     Int
  riskScore   Int
  timestamp   DateTime @default(now())

  @@index([patientId])
}